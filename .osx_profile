ICONS_DIR="$HOME/.icons"
SHORTTERM_DIR="$HOME/Desktop/short-term"
REZ="/usr/bin/Rez"

# Ruby
if which rbenv > /dev/null; then eval "$(rbenv init -)"; fi
export RBENV_ROOT=/usr/local/opt/rbenv
eval "$(rbenv init -)"

#PATH=$PATH:$HOME/.rvm/bin # Add RVM to PATH for scripting
#[[ -s "/Users/michael/.rvm/scripts/rvm" ]] && source "/Users/michael/.rvm/scripts/rvm"  # This loads RVM into a shell session.
#rvm use 1.9.2

# Scala/Java
export JAVA_HOME=`/usr/libexec/java_home`
export PATH="/usr/local/scala/bin:$PATH"
SBT_OPTS="-XX:+CMSClassUnloadingEnabled -XX:MaxPermSize=256M"

alias ls="ls -G"
alias FlushDns="sudo dscacheutil -flushcache"
alias vihosts="sudo vi /etc/hosts && sudo dscacheutil -flushcache"

# Add ctags for ShowFunc.vom
if [ ! -f /usr/local/bin/ctags ]
then
  brew install ctags
fi

# Create SHORTTERM_DIR
SHORTDIR_BASE=$(basename $SHORTTERM_DIR)
if [[ ! -d "${SHORTTERM_DIR}" ]]
then
  printf "Creating screen capture directory $SHORTTERM_DIR ... "
  mkdir -p "$SHORTTERM_DIR"
  
  ICON_ORIG="${ICONS_DIR}/${SHORTDIR_BASE}.png"
  if [ -f "${ICON_ORIG}" ]
  then
    printf "with icon ${ICON_ORIG} ... "
    ORIG_EXT=$(echo "${ICON_ORIG}" |awk -F . '{print $NF}')
    ICON_FILE="/tmp/${SHORTDIR_BASE}.${ORIG_EXT}"
    cp "${ICON_ORIG}" "${ICON_FILE}"
    sips -i "${ICON_FILE}" > /dev/null
    xattr -w com.apple.metadata:kMDItemFinderComment "${ICON_FILE}" "${SHORTTERM_DIR}"

    printf "DeRez ... "
    DeRez -only icns "${ICON_FILE}" > "/tmp/${SHORTDIR_BASE}.rscs"

    printf "Rez ... "
    Rez -append "/tmp/${SHORTDIR_BASE}.rscs" -o `printf "${SHORTTERM_DIR}/Icon\r"`

    printf "SetFile ... "
    SetFile -a C "${SHORTTERM_DIR}/"
    SetFile -a V `printf "${SHORTTERM_DIR}/Icon\r"`
  fi
  echo "done."
fi

# Set screen capture location to SHORTTERM_DIR
if [ $(defaults read com.apple.screencapture location) != "{SHORTTERM_DIR}" ]
then
  defaults write com.apple.screencapture location "${SHORTTERM_DIR}"
  killall SystemUIServer
fi

